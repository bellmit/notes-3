分库分表就是为了解决由于数据量过大而导致数据库性能降低的问题，将原来独立的数据库拆分成若干数据库组成，将数据大表拆分成若干数据表组成，使得单一数据库、单一数据表的数据量变小，从而达到提升数据库性能的目的。

分库分表包括**分库**和**分表**两个部分，在生产中通常包括：垂直分库、水平分库、垂直分表、水平分表四种方式。

分库和分表的区别就是：分库可以使用多物理机提供更高的并发能力。

# 1、垂直切分

将一个表按照字段分成多表，每个表存储其中一部分字段。将访问频次低的信息单独存放在一张表中，访问频次较高的信息单独放在一张表中。

**切分拆分结果：**

1. 每个表（库）的结构都一样。
2. 每个表（库）的数据都不一样，没有交集。
3. 所有表（库）的并集是全量数据。

**垂直拆分的原则：**

1. 把不常用的字段单独放在一张表（热点数据放在一张表中）。
2. 把 TEXT、BLOB 等大字段拆分出来放在附表中。
3. 经常组合查询的列放在一张表中。

**优点：**

1. 行数据占用内存变小了，提高了磁盘IO效率。

**缺点：**

1. 依然存在单表数据量过大的问题

# 2、水平切分

为了解决垂直切分后单表数据量依然过大的问题，引入了水平切分，如果是库内的水平切分，大家还是竞争同一物理机的CPU、内存、网络IO，最好通过分库的水平切分来解决。

**切分结果：**

1. 每个库的结构都一样。
2. 每个库的数据都不一样，没有交集。
3. 所有库的并集是全量数据。

**水平切分的原则：**

1. 单表数据量达到 800 ~ 1000 万，并且通过垂直切分无法满足要求时。

优点：

1. 不存在单库数据量过大、高并发的性能瓶颈。

缺点：

1. 关联查询基本不可能。

# 问题：为什么大字段或列过多 IO 效率低？

1. 由于数据量本身大，需要更长的读取时间。
2. 跨页，页是数据库存储单位，很多查找及定位操作都是以页为单位，单页内的数据行越多数据库整体性能越好，而大字段占用空间大，单页内存储行数少，因此IO效率较低。
3. 数据库以行为单位将数据加载到内存中，这样表中字段长度较短且访问频率较高，内存能加载更多的数据，命中率更高，减少了磁盘IO，从而提升了数据库性能。