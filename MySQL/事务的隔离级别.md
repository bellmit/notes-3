# 一、事务的隔离级别有哪些？

1. 读未提交
2. 读已提交
3. 可重复度
4. 序列化读

# 二、如何修改事务隔离级别？

1、启动 MySQL 时加入参数：`--transaction-isolation=level`，level 默认是 `REPEATABLE-READ`，可选择参数有：`READ-UNCOMMITTED`、`READ-COMMITTED`、`REPEATABLE-READ`、`SERIALIZABLE`。

2、配置文件中加入：`transaction-isolation = REPEATABLE-READ`

3、运行时动态设置：`SET [GLOBAL | SESSION] TRANSACTION ISOLATION LEVEL SERIALIZABLE`。

# 三、查看当前事务的隔离级别

`show variables like 'transaction_isolation';`

# 四、如何启动事务

使用 `begin` 或 `start transaction` 显示开启事务，配套的提交语句是 `commit`，回滚语句是 `rollback`。

但是：`begin` 或 `start transaction` 执行完后，并不是立马启动一个事务，而是等到执行第一个 SQL 的时候开启一个事务。如果想立马开启事务，则应该使用 `start transaction with consistent snapshot` 启动事务。

**注意：**如果设置了 `set autocommit=0;` 那么你执行一个 select 语句也会开启事务，如果不 commit，则后续的数据库操作都在事务中进行。

# 五、如何监控事务运行时间

事务的运行状态 MySQL 会记录着，其实是 InnoDB 记录着，执行如下语句，查询事务执行时间大于 60 秒的事务。

`select * from information_schema.innodb_trx where TIME_TO_SEC(timediff(now(),trx_started))>60`

**开发建议**：

1. 避免长事务
2. 将竞争激烈的资源尽可能放在事务的最后去执行。
